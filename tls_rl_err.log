Traceback (most recent call last):
  File "/work/hs20307/tls-rl/rl.py", line 210, in <module>
    main()
  File "/work/hs20307/tls-rl/rl.py", line 206, in main
    reward = rl(tokenized_cluster)
  File "/work/hs20307/tls-rl/rl.py", line 102, in rl
    reward = env.calc_reward(batch)
  File "/work/hs20307/tls-rl/environment.py", line 59, in calc_reward
    + self.weights[1] * self.factual_consistency(source=source, summary=summary) \
  File "/work/hs20307/tls-rl/environment.py", line 25, in factual_consistency
    ret = cosine_similarity(source_embedding, summary_embedding)
  File "/home/hs20307/.conda/envs/env/lib/python3.9/site-packages/sklearn/metrics/pairwise.py", line 1180, in cosine_similarity
    X, Y = check_pairwise_arrays(X, Y)
  File "/home/hs20307/.conda/envs/env/lib/python3.9/site-packages/sklearn/utils/validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "/home/hs20307/.conda/envs/env/lib/python3.9/site-packages/sklearn/metrics/pairwise.py", line 149, in check_pairwise_arrays
    Y = check_array(Y, accept_sparse=accept_sparse, dtype=dtype,
  File "/home/hs20307/.conda/envs/env/lib/python3.9/site-packages/sklearn/utils/validation.py", line 63, in inner_f
    return f(*args, **kwargs)
  File "/home/hs20307/.conda/envs/env/lib/python3.9/site-packages/sklearn/utils/validation.py", line 694, in check_array
    raise ValueError(
ValueError: Expected 2D array, got 1D array instead:
array=[ 2.80955136e-02 -6.02354109e-02 -1.09720692e-01 -2.74751812e-01
  2.11739242e-01 -3.85020152e-02 -3.84413540e-01  2.44578123e-01
 -9.28421766e-02  2.77094960e-01 -5.34281075e-01 -1.62909776e-01
  2.64190972e-01 -5.07090390e-01  2.37376094e-01  8.86590630e-02
  3.54928285e-01  5.79055071e-01 -6.89495683e-01  1.97563425e-01
 -2.20576242e-01 -2.49054208e-02  6.16569221e-02  1.84563637e-01
  6.49849832e-01  1.06506005e-01 -1.92498863e-01  2.58604228e-01
  3.93064201e-01  4.96896207e-01 -1.43095985e-01 -1.70040622e-01
  1.42219841e-01 -2.41436347e-01 -1.80677652e-01  1.63134396e-01
  1.82924747e-01 -2.24846452e-02  9.36000705e-01 -1.30341396e-01
 -2.24226564e-01  1.36595041e-01  4.72215712e-02  1.90639615e-01
  1.22756273e-01 -2.46516652e-02 -5.23578167e-01 -4.43111479e-01
 -6.42297268e-02  8.12379122e-02  2.22555101e-01  6.32179081e-02
  3.74371320e-01  3.21363717e-01 -3.13421339e-01  1.25923932e-01
  3.60672295e-01  7.43764043e-01 -1.01874797e-02  2.32527271e-01
  5.02589643e-01  1.89487308e-01  1.54981256e-01  6.63411915e-02
  1.10528663e-01  2.08092064e-01 -1.64109975e-01  1.01441216e+00
  4.60369587e-02  4.80031908e-01  2.22104415e-02  5.54963052e-01
  1.43869013e-01 -7.35106394e-02  4.12295274e-02  5.80250204e-01
  7.76142478e-02  5.45815527e-01 -2.69850761e-01 -1.56382993e-01
  8.93608555e-02 -2.24392071e-01 -1.17081201e+00  3.50288481e-01
 -2.96318680e-01 -1.01239875e-01  2.50051498e-01 -1.61679670e-01
  2.23330051e-01 -1.49064779e-01 -2.55095482e-01 -4.29357231e-01
 -4.81850728e-02 -9.06340331e-02  6.17625713e-02  5.16772717e-02
 -1.24942839e-01 -6.87107682e-01  8.17773044e-02 -3.98264110e-01
  1.96884364e-01  3.75834376e-01  5.73849380e-01  2.51731694e-01
  1.33416653e-02  2.82346249e-01 -6.79198503e-01  3.32170725e-01
  5.79813838e-01 -5.13075851e-02  4.36897650e-02  7.90973186e-01
  2.08863288e-01  7.38579929e-02 -5.38963228e-02  1.94802880e-02
 -1.44567311e-01 -1.71251744e-02 -1.52329043e-01  1.37148723e-01
  2.07689613e-01  3.50053430e-01 -1.36189386e-01 -1.88023537e-01
 -2.22065508e-01 -5.99517584e-01 -1.03710867e-01  4.42022830e-02
 -8.06864277e-02  5.39220691e-01 -5.10326736e-02 -6.11242533e-01
 -1.81569368e-01  5.29084094e-02 -5.30143864e-02  2.39517823e-01
  4.21527088e-01 -4.51307595e-02  2.03699380e-01 -2.55301863e-01
  8.81743729e-02  3.69098932e-02  2.84772426e-01  8.25870782e-02
 -4.06628728e-01  1.14375092e-02  1.67262718e-01 -6.40980124e-01
  3.56592357e-01 -9.57641155e-02 -1.54438198e-01 -2.53980458e-02
  6.86013550e-02 -1.32650077e-01  2.50052869e-01 -2.44417578e-01
 -1.51759505e-01 -3.16793412e-01  8.40076134e-02 -8.14534843e-01
  2.47408196e-01 -2.63682097e-01  4.36768606e-02  7.00186864e-02
  1.84530124e-01  3.90137732e-01  4.23487723e-01  9.47515294e-03
  9.21279266e-02 -2.03327477e-01 -2.09827915e-01  2.07240097e-02
  2.11940452e-01  3.91310155e-01 -5.29968262e-01  4.59999442e-02
 -7.46874571e-01  3.74216661e-02  3.58084105e-02  2.12895155e-01
  1.35115147e-01  4.80588883e-01  3.78814578e-01 -1.11983076e-01
  2.11553231e-01 -9.30659100e-03 -3.96552607e-02 -7.16787696e-01
  2.41663456e-02  5.65664051e-03 -1.76857680e-01 -1.72804706e-02
  2.29057103e-01 -3.79946589e-01  1.79728419e-02  3.80330354e-01
 -1.08196884e-02 -3.39006573e-01 -3.53397310e-01  2.54465908e-01
  2.39981323e-01 -6.12614274e-01 -9.98728722e-02  4.47907299e-03
  2.03501433e-01 -2.68057853e-01 -7.45649338e-01 -3.66675481e-02
  3.56239110e-01 -9.06654745e-02 -6.10349923e-02 -3.16988528e-02
 -2.93238580e-01  5.26978970e-02 -6.78821057e-02  4.01568711e-01
  8.91984403e-02 -7.97959387e-01  4.18045744e-03 -1.11647105e+00
  2.80512691e-01 -5.89608252e-02  3.59618254e-02  1.82334244e-01
 -3.31293136e-01  4.49382246e-01 -1.97873563e-02 -7.73507357e-02
 -2.24585041e-01 -3.70987922e-01  3.74737382e-01  1.36508554e-01
 -3.50454360e-01 -5.13675585e-02  1.63204700e-01 -3.21937725e-02
 -5.24955988e-01  5.21099791e-02 -8.76671672e-02 -2.64678299e-01
  7.81872422e-02 -8.17993209e-02 -6.25794232e-02  4.25432503e-01
  1.11292109e-01 -4.66038585e-02  4.80445214e-02  3.56930017e-01
 -1.70945078e-01  6.52063340e-02 -2.32514039e-01  1.52896985e-01
  1.12383291e-02  1.75134137e-01  3.48397434e-01  3.14440072e-01
  5.20811319e-01 -1.33414447e-01 -3.03943783e-01  1.41004995e-02
  3.70455205e-01 -3.98388237e-01 -6.50853932e-01  1.23206042e-01
  4.09952283e-01  2.65213877e-01 -3.30122858e-02  1.11209057e-01
 -2.63986826e-01 -3.90026495e-02 -1.25267863e-01  1.94125965e-01
 -3.80556703e-01  1.17141515e-01 -2.28036761e-01 -2.20145389e-01
 -3.80823851e-01  4.03595418e-01 -6.58547059e-02 -1.55981719e-01
  1.35217067e-02  5.29123962e-01 -2.23574057e-01  4.58741188e-01
 -4.04535271e-02 -7.38166422e-02  4.86372113e-01  6.64413691e-01
 -4.26395722e-02 -5.21067739e-01  1.16173923e-03  1.74258575e-01
 -1.51657134e-01 -7.21334517e-02  1.42907768e-01  1.58858031e-01
 -1.82253391e-01  8.31053928e-02 -4.02232409e-02  4.04089779e-01
  7.41861761e-02 -2.35068560e-01 -7.76360631e-02 -3.58790100e-01
 -7.97045976e-02  3.54072988e-01 -2.67380476e-01  1.46299422e-01
 -1.94585904e-01  2.30533049e-01 -2.90694505e-01  1.86702013e-01
  4.43888098e-01 -4.90086049e-01 -5.29801250e-02  3.33622009e-01
  3.33278745e-01 -6.79591656e-01  1.87192798e-01  3.77187878e-01
 -4.20057774e-03  1.21123791e-02 -3.48952144e-01  2.32245699e-01
  1.47997767e-01  6.71931326e-01  1.43051565e-01  3.65828395e-01
  9.22482461e-02  8.26423243e-02 -7.88953722e-01 -4.10088807e-01
  3.92179459e-01  1.42612427e-01 -1.92886889e-02  9.35222134e-02
  5.70174456e-02  6.98210150e-02 -8.11579227e-02  1.71953484e-01
 -2.90922225e-02  3.86569858e-01 -5.40540963e-02 -1.47448361e-01
 -3.24336588e-01  2.36097246e-01 -5.85714579e-01  5.62020317e-02
 -5.96710563e-01  2.55336538e-02 -2.47820809e-01  8.98215994e-02
 -4.08172458e-02 -2.43772566e-02 -1.62078321e-01  1.19500786e-01
  2.56708235e-01 -2.80218959e-01 -3.47021893e-02  4.04257625e-01
 -3.49340856e-01  3.21869105e-01  1.84813172e-01  2.36475527e-01
 -1.30747616e-01 -6.59522831e-01 -8.40636432e-01 -2.50852108e-01
  1.85261309e-01  7.07628131e-02 -3.52232456e-02  2.61647552e-02
  1.87547177e-01  7.38100171e-01 -1.08054593e-01  1.23994887e-01
  5.36705256e-02 -2.63454527e-01  1.45324558e-01 -6.33761212e-02
  2.32369721e-01 -5.40033635e-03  2.66455203e-01  2.01815575e-01
 -1.72557309e-01  8.58381152e-01  8.40611756e-02  5.70689499e-01
  2.32641548e-01 -1.17626101e-01  1.80857092e-01 -1.48794249e-01
 -1.93234921e-01 -2.25186929e-01  1.57741979e-02 -1.28216475e-01
 -3.10871124e-01 -3.01227272e-01 -2.72597164e-01 -3.45657617e-02
  3.33919609e-03  4.10278797e-01 -2.33904317e-01 -8.99959654e-02
 -2.82903612e-01  1.10496557e+00 -3.32905427e-02 -2.02402726e-01
 -1.08796723e-01  4.43745643e-01 -3.76827091e-01 -3.92899364e-01
  1.11877076e-01 -7.09811985e-01 -1.14248373e-01 -3.66677374e-01
  6.90866053e-01 -5.32204807e-01 -3.68849896e-02  2.82543182e-01
 -8.40502381e-02  6.36186004e-02  1.25109255e-01 -2.89891094e-01
  2.45613620e-01  6.21448494e-02 -4.53930348e-02 -1.98895305e-01
  3.35317075e-01 -3.19559455e-01  5.11805773e-01 -5.25412410e-02
 -7.95034289e-01  3.35181840e-02 -1.99775308e-01  2.86049485e-01
  1.97578013e-01 -2.34149858e-01  1.43649042e-01  5.10275424e-01
  8.38535428e-01 -3.59273285e-01 -2.11611576e-02 -1.62194327e-01
 -2.28705376e-01  2.20749408e-01  2.01091737e-01  1.59369588e-01
 -1.47587135e-01 -2.56906390e-01  1.70139551e-01 -5.22313476e-01
 -2.15973675e-01  2.47392803e-01  2.68910229e-01  3.04299314e-02
 -1.25333443e-02 -4.52964716e-02  1.41246766e-02  4.22794759e-01
  6.11037791e-01 -2.82854587e-01 -6.07216656e-02 -1.48975387e-01
  4.40049529e-01 -1.06432706e-01  1.95042893e-01 -1.48169413e-01
 -4.73848283e-01  2.42328718e-01  3.66947323e-01  5.65066814e-01
  2.56264210e-03  2.17461050e-01  1.84467778e-01 -9.88572687e-02
  1.68544590e-01 -3.75473261e-01 -7.07929209e-02  2.00590417e-02
 -1.28060475e-01  2.47609206e-02  8.59788060e-02  1.87423080e-01
  2.15822741e-01 -1.74216107e-01 -1.06572866e-01  1.66140765e-01
  5.20136058e-02  2.06809461e-01  1.62726700e-01 -3.98509443e-01
  2.31563941e-01  2.61117101e-01  4.30964351e-01  1.69068784e-01
  3.41446370e-01 -4.14448917e-01 -4.85353470e-01 -4.91440296e-02
 -4.44813371e-02 -8.79853815e-02 -3.70831192e-02 -5.53604886e-02
 -3.69030058e-01  1.50287777e-01  4.02741730e-01 -2.49915421e-02
  1.02257401e-01  2.21112967e-01  4.49703336e-02  1.74447119e-01
  9.55991223e-02 -1.03898883e-01  2.09065840e-01 -1.13698751e-01
  1.95576727e-01 -1.77497014e-01  5.74378848e-01  3.28446865e-01
 -3.06443930e-01 -9.32499021e-03 -1.70645751e-02 -1.94399476e-01
 -1.30148679e-01 -1.46182254e-01  2.13484824e-01  2.13251024e-01
 -1.16236061e-02 -3.37396860e-01  4.71961737e-01  5.11262119e-01
  9.82100889e-02 -1.24578178e-03 -1.74867630e-01  2.31281608e-01
  1.57622442e-01  1.97830230e-01 -8.57486725e-01 -2.97597438e-01
  5.52266359e-01  2.17969179e-01 -4.72123139e-02 -2.70162046e-01
  1.01688214e-01  4.27208185e-01  2.42595881e-01 -2.66370833e-01
 -1.72241077e-01  3.83861363e-01 -3.27556044e-01 -4.79364514e-01
  2.01715380e-02 -1.00664489e-01  6.38739705e-01 -1.01837948e-01
  5.59808016e-02  7.85987005e-02 -4.25380439e-01  1.58556044e-01
  4.17265147e-02  2.33619586e-02 -3.97298485e-02  6.45816028e-01
 -5.32553315e-01  1.88642204e-01  4.97082472e-02 -1.49241894e-01
  1.84526846e-01  2.58427411e-02 -5.60997427e-01  4.54652011e-02
 -1.15450360e-01 -9.71940339e-01 -4.96743441e-01  2.66165640e-02
  1.21570706e-01 -1.23078011e-01 -9.41562474e-01  2.89404690e-02
  1.62608743e-01  5.78415543e-02  1.82934791e-01 -4.14586037e-01
  2.58007616e-01 -6.64679766e-01 -6.93771467e-02 -1.27694219e-01
  4.13997710e-01 -6.72993958e-02  2.82117218e-01 -2.72771418e-01
 -1.49965614e-01  1.74010366e-01  3.59299868e-01 -1.46985203e-01
 -3.55042130e-01  4.82537866e-01  2.26591825e-02 -5.41907586e-02
 -2.32696295e-01  6.76972717e-02  5.18190861e-01  2.21634120e-01
 -4.96380031e-02 -9.94963124e-02  1.22734889e-01 -3.80267352e-01
 -1.46541968e-02  1.03421368e-01  8.06556344e-02  2.81136632e-01
  1.15118302e-01  9.00238872e-01 -3.96940261e-01  6.63037524e-02
 -1.05399042e-02  1.69435576e-01 -9.39173475e-02  4.34406042e-01
 -4.45584469e-02  9.78210866e-02  2.48293400e-01 -5.10799289e-01
 -2.30883390e-01  9.55395401e-02  3.49428318e-02 -3.70575003e-02
  5.84000498e-02 -2.30303183e-01  7.47277498e-01  4.75627631e-01
  3.00462723e-01  5.95399737e-02  1.44244432e-01 -1.26829982e-01
  5.90926170e-01  6.85304850e-02  7.02658594e-01 -1.28276661e-01
  1.98295355e-01 -2.72589922e-01 -3.52623463e-01  3.75629276e-01
 -4.17119294e-01  6.42788857e-02  2.52536178e-01 -3.04778874e-01
 -3.51689979e-02  2.04238653e-01  3.61354947e-02  3.83349746e-01
 -3.43762517e-01 -6.32709488e-02  4.58258599e-01 -6.78023815e-01
 -1.96239546e-01 -3.27617675e-02 -2.40750611e-03  4.13242519e-01
 -3.46674830e-01 -1.39978409e-01  3.61124218e-01 -5.19270062e-01
  1.24473259e-01 -3.24662328e-01  1.35124579e-01 -6.56980872e-02
  3.45307052e-01 -1.56168371e-01 -1.36562228e-01 -1.58666521e-01
  2.78272837e-01  2.46945560e-01  6.75767720e-01 -1.19919792e-01
 -4.87566411e-01  2.66445011e-01  4.22235250e-01 -2.34566167e-01
 -4.01706755e-01 -8.00760165e-02 -3.00994441e-02 -4.12682742e-02
  5.62042966e-02 -4.77292895e-01 -5.86156920e-03  2.85547853e-01
  3.34455669e-01  7.89332390e-03 -6.06453270e-02 -3.09220627e-02
 -2.68485069e-01  1.39546692e-02  1.54568166e-01 -4.07847129e-02
  2.50127435e-01 -2.41961405e-01  2.82312334e-01  1.39155820e-01
  2.29792371e-01 -3.01683336e-01 -2.01234892e-02 -3.64049643e-01
  1.96428463e-01  1.22704096e-01 -1.17769502e-01  1.92942455e-01
  4.61880118e-01 -3.99229825e-01 -1.54464066e-01 -1.43219531e-03
 -8.48855227e-02 -3.04141194e-01 -1.09946847e-01 -1.60512477e-01
  4.90198076e-01  1.84456736e-01  2.78266072e-01  1.34359866e-01
 -6.35377020e-02  3.17037225e-01  4.28644344e-02 -6.58001065e-01
 -2.61542052e-01 -2.16536850e-01 -9.07510072e-02  1.24148443e-01
 -5.41968644e-03 -1.33715272e-01 -4.96205688e-03 -3.79925609e-01
  2.48368144e-01  4.04788166e-01  6.73249722e-01 -3.40734422e-01
 -7.64945894e-03  1.33794636e-01  1.22446775e-01 -2.80608803e-01
 -4.36502814e-01  9.25979912e-02 -6.92833513e-02  2.59102106e-01
 -1.82627290e-02 -3.41049343e-01 -9.08647701e-02  1.92601979e-02
  3.84255171e-01 -1.93903163e-01  5.11543453e-02 -8.33365381e-01
  6.87017024e-01  3.33371431e-01 -4.38810468e-01 -2.13426918e-01
 -2.01193720e-01 -6.92014694e-02  5.77257812e-01 -3.53847504e-01
  1.92339569e-01  3.20796609e-01 -4.16422546e-01  6.02093786e-02
 -5.67755938e-01 -2.96760827e-01  5.62555119e-02 -8.27491283e-03].
Reshape your data either using array.reshape(-1, 1) if your data has a single feature or array.reshape(1, -1) if it contains a single sample.
